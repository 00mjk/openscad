branches:
  only:
    - win-build

image:
  - Visual Studio 2017

init:
  # Uncomment to enable RDP login at init time, this will not block job execution.
  - ps: iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))

install:
  - ps: Get-Date -UFormat '### %Y-%m-%d %T install started'

build_script:
  - ps: Get-Date -UFormat '### %Y-%m-%d %T build started'

artifacts:
  - path: 'tests\Testing\Temporary\*_report.html'

# Uncomment RDP login at job end with specical blocking flag to prevent the worker from exitting. Continue by deleting lock file on desktop.
# Alternatively if RDP is already enabled earlier, just adding "pause" will block the worker till timeout (60 minutes).
#on_finish:
#  - ps: $blockRdp = $true; iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))
#  - pause
