name: openscad-nightly
version: 'git'
summary: Script file based graphical CAD environment
description: |
  OpenSCAD is a software for creating solid 3D CAD objects. It focuses on CAD
  aspects rather than artistic ones.
  .
  OpenSCAD is not an interactive modeller. Instead it is something like a
  3D-compiler that reads in a script file that describes the object and renders
  the 3D model from this script. This gives the designer full control over the
  modelling process and enables him to easily change any step in the modelling
  process or make designes that are defined by configurable parameters.
  .
  NOTE: This is the development snapshot, automatically built from the source
  repository.

grade: devel
confinement: devmode

parts:
  openscad-nightly:
    plugin: qmake
    qt-version: qt5
    project-files: [ "openscad.pro" ]
    options: [ "PREFIX=/usr", "CONFIG+=experimental", "CONFIG-=debug", "SUFFIX=-nightly" ]
    override-build: |
      qmake PREFIX=/usr CONFIG+=experimental CONFIG-=debug SUFFIX=-nightly
      sed -i 's/QINSTALL_PROGRAM\s*=.*/QINSTALL_PROGRAM = $(INSTALL_PROGRAM)/g' "$SNAPCRAFT_PART_INSTALL/../build/Makefile"
      sed -i 's/QINSTALL\s*=.*/QINSTALL = $(INSTALL_DIR)/g' "$SNAPCRAFT_PART_INSTALL/../build/Makefile"
      export TMPDIR="$SNAPCRAFT_PART_INSTALL"
      make install INSTALL_ROOT="$SNAPCRAFT_PART_INSTALL"

