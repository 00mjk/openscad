start 100
// list_comprehensions.scad - Examples of list comprehension usage

// Basic list comprehension:
// Returns a 2D vertex per iteration of the for loop<11>
</11><10>// Note: subsequent assignments inside the for loop is allowed</10><11>
</11><1>module</1><11> </11><8>ngon</8><11>(</11><8>num</8><11>,</11><11> </11><8>r</8><11>)</11><11> </11><11>{</11><11>
</11><11> </11><11> </11><5>polygon</5><11>(</11><11>[</11><1>for</1><11> </11><11>(</11><8>i</8><6>=</6><11>[</11><7>0</7><11>:</11><8>num</8><11>-</11><7>1</7><11>]</11><11>,</11><11> </11><8>a</8><6>=</6><8>i</8><11>*</11><7>360</7><11>/</11><8>num</8><11>)</11><11> </11><11>[</11><11> </11><8>r</8><11>*</11><4>cos</4><11>(</11><8>a</8><11>)</11><11>,</11><11> </11><8>r</8><11>*</11><4>sin</4><11>(</11><8>a</8><11>)</11><11> </11><11>]</11><11>]</11><11>)</11><11>;</11><11>
</11><11>}</11><11>
</11><11>
</11><8>ngon</8><11>(</11><7>3</7><11>,</11><11> </11><7>10</7><11>)</11><11>;</11><11>
</11><2>translate</2><11>(</11><11>[</11><7>20</7><11>,</11><7>0</7><11>]</11><11>)</11><11> </11><8>ngon</8><11>(</11><7>6</7><11>,</11><11> </11><7>8</7><11>)</11><11>;</11><11>
</11><2>translate</2><11>(</11><11>[</11><7>36</7><11>,</11><7>0</7><11>]</11><11>)</11><11> </11><8>ngon</8><11>(</11><7>10</7><11>,</11><11> </11><7>6</7><11>)</11><11>;</11><11>
</11><11>
</11><10>// More complex list comprehension:</10><11>
</11><10>// Similar to ngon(), but uses an inner function to calculate</10><11>
</11><10>// the vertices. the let() keyword allows assignment of temporary variables.</10><11>
</11><1>module</1><11> </11><8>rounded_ngon</8><11>(</11><8>num</8><11>,</11><11> </11><8>r</8><11>,</11><11> </11><8>rounding</8><11> </11><6>=</6><11> </11><7>0</7><11>)</11><11> </11><11>{</11><11>
</11><11> </11><11> </11><1>function</1><11> </11><8>v</8><11>(</11><8>a</8><11>)</11><11> </11><6>=</6><11> </11><1>let</1><11> </11><11>(</11><8>d</8><11> </11><6>=</6><11> </11><7>360</7><11>/</11><8>num</8><11>,</11><11> </11><8>v</8><11> </11><6>=</6><11> </11><4>floor</4><11>(</11><11>(</11><8>a</8><11>+</11><8>d</8><11>/</11><7>2</7><11>)</11><11>/</11><8>d</8><11>)</11><11>*</11><8>d</8><11>)</11><11> </11><11>(</11><8>r</8><11>-</11><8>rounding</8><11>)</11><11> </11><11>*</11><11> </11><11>[</11><4>cos</4><11>(</11><8>v</8><11>)</11><11>,</11><11> </11><4>sin</4><11>(</11><8>v</8><11>)</11><11>]</11><11>;</11><11>
</11><11> </11><11> </11><5>polygon</5><11>(</11><11>[</11><1>for</1><11> </11><11>(</11><8>a</8><6>=</6><11>[</11><7>0</7><11>:</11><7>360</7><11>-</11><7>1</7><11>]</11><11>)</11><11> </11><8>v</8><11>(</11><8>a</8><11>)</11><11> </11><11>+</11><11> </11><8>rounding</8><11>*</11><11>[</11><4>cos</4><11>(</11><8>a</8><11>)</11><11>,</11><4>sin</4><11>(</11><8>a</8><11>)</11><11>]</11><11>]</11><11>)</11><11>;</11><11>
</11><11>}</11><11>
</11><11>
</11><2>translate</2><11>(</11><11>[</11><7>0</7><11>,</11><7>22</7><11>]</11><11>)</11><11> </11><8>rounded_ngon</8><11>(</11><7>3</7><11>,</11><11> </11><7>10</7><11>,</11><11> </11><7>5</7><11>)</11><11>;</11><11>
</11><2>translate</2><11>(</11><11>[</11><7>20</7><11>,</11><7>22</7><11>]</11><11>)</11><11> </11><8>rounded_ngon</8><11>(</11><7>6</7><11>,</11><11> </11><7>8</7><11>,</11><11> </11><7>4</7><11>)</11><11>;</11><11>
</11><2>translate</2><11>(</11><11>[</11><7>36</7><11>,</11><7>22</7><11>]</11><11>)</11><11> </11><8>rounded_ngon</8><11>(</11><7>10</7><11>,</11><11> </11><7>6</7><11>,</11><11> </11><7>3</7><11>)</11><11>;</11><11>
</11><11>
</11><10>// Gear/star generator</10><11>
</11><10>// Uses a list comprehension taking a list of radii to generate a star shape</10><11>
</11><1>module</1><11> </11><8>star</8><11>(</11><8>num</8><11>,</11><11> </11><8>radii</8><11>)</11><11> </11><11>{</11><11>
</11><11> </11><11> </11><1>function</1><11> </11><8>r</8><11>(</11><8>a</8><11>)</11><11> </11><6>=</6><11> </11><11>(</11><4>floor</4><11>(</11><8>a</8><11> </11><11>/</11><11> </11><7>10</7><11>)</11><11> </11><11>%</11><11> </11><7>2</7><11>)</11><11> </11><11>?</11><11> </11><7>10</7><11> </11><11>:</11><11> </11><7>8</7><11>;</11><11>
</11><11> </11><11> </11><5>polygon</5><11>(</11><11>[</11><1>for</1><11> </11><11>(</11><8>i</8><6>=</6><11>[</11><7>0</7><11>:</11><8>num</8><11>-</11><7>1</7><11>]</11><11>,</11><11> </11><8>a</8><6>=</6><8>i</8><11>*</11><7>360</7><11>/</11><8>num</8><11>,</11><11> </11><8>r</8><6>=</6><8>radii</8><11>[</11><8>i</8><11>%</11><4>len</4><11>(</11><8>radii</8><11>)</11><11>]</11><11>)</11><11> </11><11>[</11><11> </11><8>r</8><11>*</11><4>cos</4><11>(</11><8>a</8><11>)</11><11>,</11><11> </11><8>r</8><11>*</11><4>sin</4><11>(</11><8>a</8><11>)</11><11> </11><11>]</11><11>]</11><11>)</11><11>;</11><11>
</11><11>}</11><11>
</11><11>
</11><2>translate</2><11>(</11><11>[</11><7>0</7><11>,</11><7>44</7><11>]</11><11>)</11><11> </11><8>star</8><11>(</11><7>20</7><11>,</11><11> </11><11>[</11><7>6</7><11>,</11><7>10</7><11>]</11><11>)</11><11>;</11><11>
</11><2>translate</2><11>(</11><11>[</11><7>20</7><11>,</11><7>44</7><11>]</11><11>)</11><11> </11><8>star</8><11>(</11><7>40</7><11>,</11><11> </11><11>[</11><7>6</7><11>,</11><7>8</7><11>,</11><7>8</7><11>,</11><7>6</7><11>]</11><11>)</11><11>;</11><11>
</11><2>translate</2><11>(</11><11>[</11><7>36</7><11>,</11><7>44</7><11>]</11><11>)</11><11> </11><8>star</8><11>(</11><7>30</7><11>,</11><11> </11><11>[</11><7>3</7><11>,</11><7>4</7><11>,</11><7>5</7><11>,</11><7>6</7><11>,</11><7>5</7><11>,</11><7>4</7><11>]</11><11>)</11><11>;</11><11>
</11><11>
</11><1>echo</1><11>(</11><4>version</4><6>=</6><4>version</4><11>(</11><11>)</11><11>)</11><11>;</11><11>
</11><10>// Written by Marius Kintel <marius@kintel.net></10><11>
</11><10>//</10><11>
</11><10>// To the extent possible under law, the author(s) have dedicated all</10><11>
</11><10>// copyright and related and neighboring rights to this software to the</10><11>
</11><10>// public domain worldwide. This software is distributed without any</10><11>
</11><10>// warranty.</10><11>
</11><10>//</10><11>
</11><10>// You should have received a copy of the CC0 Public Domain</10><11>
</11><10>// Dedication along with this software.</10><11>
</11><10>// If not, see <http://creativecommons.org/publicdomain/zero/1.0/>.</10><11>
</11>